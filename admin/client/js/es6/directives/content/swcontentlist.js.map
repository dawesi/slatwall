{"version":3,"sources":["directives/content/swcontentlist.ts"],"names":[],"mappings":"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","file":"directives/content/swcontentlist.js","sourceRoot":"/Users/ianhickey/Sites/Slatwall/","sourcesContent":["'use strict';\n\nangular.module('slatwalladmin')\n.directive('swContentList', [\n\t'$log',\n    '$timeout',\n\t'$slatwall',\n\t'partialsPath',\n    'paginationService',\n\tfunction (\n\t\t\t$log,\n            $timeout,\n\t\t\t$slatwall,\n\t\t\tpartialsPath,\n            paginationService\n\t) {\n\t    return {\n\t        restrict: 'E',\n\t        templateUrl:partialsPath+'content/contentlist.html',\n\t        link: function (scope, element, attr) {\n\t        \t$log.debug('slatwallcontentList init');\n\t        \tvar pageShow = 50;\n                if(scope.pageShow !== 'Auto'){\n                    pageShow = scope.pageShow;\n                }\n                \n                scope.loadingCollection = false;\n\t        \t\n\t        \tscope.getCollection = function(isSearching){\n                    var columnsConfig = [\n                        {\n                            propertyIdentifier:'_content.contentID',\n                            isVisible:false,\n                            ormtype:'id',\n                            isSearchable:false\n                        },\n                        {\n                            propertyIdentifier:'_content.site.siteName',\n                            isVisible:true,\n                            ormtype:'string',\n                            isSearchable:true\n                        },\n                        {\n                            propertyIdentifier:'_content.contentTemplateFile',\n                            persistent:false,\n                            setting:true,\n                            isVisible:true,\n                            isSearchable:false\n                        },\n                        //need to get template via settings\n                        {\n                            propertyIdentifier:'_content.allowPurchaseFlag',\n                            isVisible:true,\n                            isSearchable:false\n                        },\n                        {\n                            propertyIdentifier:'_content.productListingPageFlag',\n                            isVisible:true,\n                            isSearchable:false\n                        },\n                        {\n                            propertyIdentifier:'_content.activeFlag',\n                            isVisible:true,\n                            isSearchable:false\n                        }\n                    ];\n                    \n                    var filterGroupsConfig =[\n                        {\n                          \"filterGroup\": [\n                            {\n                              \"propertyIdentifier\": \"_content.parentContent\",\n                              \"comparisonOperator\": \"is\",\n                              \"value\": 'null'\n                            }\n                          ]\n                        }\n                      ];\n                    \n\t        \t\tvar options = {\n                        currentPage:scope.currentPage, \n                        pageShow:pageShow, \n                        keywords:scope.keywords\n                    };\n                    var column = {};\n                    if(!isSearching || scope.keywords === ''){\n                        options.filterGroupsConfig = angular.toJson(filterGroupsConfig);\n                         column = {\n                            propertyIdentifier:'_content.title',\n                            isVisible:true,\n                            ormtype:'string',\n                            isSearchable:true\n                        };\n                        \n                    }else{\n                        column = {\n                            propertyIdentifier:'_content.fullTitle',\n                            isVisible:true,\n                            persistent:false\n                        };  \n                    }\n                    columnsConfig.unshift(column);\n                    options.columnsConfig = angular.toJson(columnsConfig);\n                    \n\t        \t\tvar collectionListingPromise = $slatwall.getEntity(\n                        scope.entityName, \n                        options\n                    );\n\t        \t\tcollectionListingPromise.then(function(value){\n\t        \t\t\tscope.collection = value;\n\t        \t\t\tscope.collectionConfig = angular.fromJson(scope.collection.collectionConfig);\n\t        \t\t\tscope.collectionConfig.columns = columnsConfig;\n\t        \t\t\tscope.collection.collectionConfig = scope.collectionConfig;\n                        scope.loadingCollection = false;\n\t        \t\t\t//scope.contents = $slatwall.populateCollection(value.pageRecords,scope.collectionConfig);\n\t        \t\t});\n\t        \t};\n\t        \tscope.getCollection(false);\n                \n                scope.keywords = \"\";\n                scope.loadingCollection = false;\n                var searchPromise;\n                scope.searchCollection = function(){\n                    \n                    if(searchPromise) {\n                        $timeout.cancel(searchPromise);\n                    }\n                    \n                    searchPromise = $timeout(function(){\n                        $log.debug('search with keywords');\n                        $log.debug(scope.keywords);\n                        $('.childNode').remove();\n                        //Set current page here so that the pagination does not break when getting collection\n                        paginationService.setCurrentPage(1);\n                        scope.loadingCollection = true;\n                        scope.getCollection(true);\n                    }, 500);\n                };\n                \n\t    }\n\t}\n}]);"]}